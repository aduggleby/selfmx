---
layout: ../../layouts/DocsLayout.astro
title: Domain Management
description: Configure and manage domains for sending emails with SelfMX.
---

This guide explains how to add, verify, and manage domains in SelfMX.

## Overview

Before sending emails from a domain, you need to:

1. Add the domain to SelfMX
2. Configure DNS records for verification
3. Wait for AWS SES to verify the domain

SelfMX automates most of this process and provides tools to help you configure your DNS.

## Adding a Domain

### Via Dashboard

1. Navigate to the SelfMX dashboard
2. Click **Add domain** (or fill the form if no domains exist)
3. Enter your domain name (e.g., `example.com`)
4. Click **Add domain**

You'll be redirected to the domain detail page showing the required DNS records.

### Via API

```bash
curl -X POST http://localhost:8080/v1/domains \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"name": "example.com"}'
```

## DNS Configuration

After adding a domain, SelfMX generates DNS records required for email verification. These typically include:

| Record Type | Purpose |
|-------------|---------|
| CNAME | DKIM signing (3 records) |
| TXT | Domain verification |
| MX | Mail routing (optional) |

### Viewing DNS Records

On the domain detail page, you'll see all required DNS records displayed in a table with:

- **Type**: The DNS record type (CNAME, TXT, MX)
- **Name**: The record name (hostname)
- **Value**: The record value to set

### Downloading DNS Records

Click **Download DNS Records** to download a BIND-format zone file. This file can be imported into most DNS providers or used with BIND servers directly.

The downloaded file includes:

```
; DNS Records for example.com
; Generated by SelfMX
; Import this file in your DNS provider

$ORIGIN example.com.
$TTL 3600

token1._domainkey.example.com	IN	CNAME	token1.dkim.amazonses.com.
token2._domainkey.example.com	IN	CNAME	token2.dkim.amazonses.com.
token3._domainkey.example.com	IN	CNAME	token3.dkim.amazonses.com.
```

### Cloudflare Integration

If you use Cloudflare for DNS, click **Add to Cloudflare** to open the Cloudflare dashboard directly to your domain's DNS settings page. From there, you can manually add the records.

The button opens: `https://dash.cloudflare.com/?to=/:account/example.com/dns`

> **Note**: The Cloudflare integration requires you to be logged into your Cloudflare account. If you have multiple accounts, Cloudflare will prompt you to select one.

## Domain Status

Domains progress through these verification states:

| Status | Description |
|--------|-------------|
| **Pending** | Domain added, waiting for DNS setup job to run |
| **Verifying** | DNS records created, waiting for verification |
| **Verified** | Domain verified and ready for sending |
| **Failed** | Verification failed (check failure reason) |

### Verification Timeline

- DNS changes can take up to 48 hours to propagate globally
- SelfMX checks verification status every 5 minutes
- Most domains verify within 1-2 hours

### Verification Failures

If verification fails, the domain detail page shows the failure reason. Common causes:

- **DNS records not found**: Records weren't added or haven't propagated
- **Incorrect values**: Record values don't match exactly
- **Timeout**: Verification didn't complete within 72 hours

To retry verification, delete the domain and add it again.

## Deleting a Domain

### Via Dashboard

1. Navigate to the domain detail page
2. Click **Delete domain**
3. Confirm the deletion

### Via API

```bash
curl -X DELETE http://localhost:8080/v1/domains/DOMAIN_ID \
  -H "Authorization: Bearer YOUR_API_KEY"
```

> **Warning**: Deleting a domain removes it from AWS SES. You'll need to re-verify if you add it again.

## Best Practices

### Use Subdomains for Transactional Email

Consider using a subdomain like `mail.example.com` or `notify.example.com` for transactional emails. This:

- Separates transactional and marketing email reputation
- Allows different configurations per use case
- Makes troubleshooting easier

### Keep DNS Records Updated

If you change DNS providers:

1. Export DNS records from SelfMX before migrating
2. Import records into your new DNS provider
3. Verify records propagated correctly

### Monitor Domain Health

Regularly check that:

- Domains remain verified
- DNS records haven't been accidentally removed
- No unexpected failures appear

## Troubleshooting

### Domain Stuck in "Verifying"

1. Verify DNS records were added correctly
2. Check DNS propagation using tools like `dig` or [DNS Checker](https://dnschecker.org)
3. Ensure records match exactly (including trailing dots for CNAMEs)

### Cannot Send from Domain

Ensure the domain is in **Verified** status. Check:

- API key has permission to send from this domain
- The "from" address uses the verified domain
- AWS SES sending limits haven't been exceeded

## Next Steps

- [API Endpoints](/api/endpoints) - Domain API reference
- [Troubleshooting](/guides/troubleshooting) - General troubleshooting guide
- [Multi-Tenancy](/concepts/tenants) - Managing multiple domains and API keys
